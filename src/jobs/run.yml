description: >
  A single, complete job to run.
executor: default

parameters:
  image_name:
    type: string
    default: ""
  image_tag:
    type: string
    default: ${CIRCLE_SHA1}
  ecr_url:
    type: string
    default: 958549588201.dkr.ecr.us-east-1.amazonaws.com
  tag:
    type: string
    default: current
  dotenv:
    type: string
    default: dev


steps:
  - quality
  - build_application:
      image_name: << parameters.image_name >>
      image_tag: << parameters.image_tag >>
      ecr_url: << parameters.ecr_url >>
  - update_service:
      image_name: << parameters.image_name >>
      image_tag: << parameters.image_tag >>
      ecr_url: << parameters.ecr_url >>
      tag: << parameters.tag >>
      dotenv: << parameters.dotenv >>
